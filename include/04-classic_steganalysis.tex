%Общий объем раздела 20-30 стр.

\section{Анализ предметной области. Обзор известных работ в области стегоанализа}

\subsection{Базовые понятия и положения стеганографии}

\textit{Стеганография} (от греч. στεγανός — скрытый и γράφω — пишу; буквально «тайнопись») — это наука о передаче (хранении) информации с сохранением в тайне самого факта передачи (хранения). Большинство способов классической цифровой стеганографии базируется на особенностях восприятия информации человеком, организуя сокрытие секретных сообщений таким образом, что чувствительность человеческих органов не позволяет определить их наличие.

Основными понятиями стеганографии являются понятия контейнера, сообщения и ключа. Ниже приведены их определения, данные в монографии~\cite{Agranovskiy}.

\textit{Контейнером} $ b $ ($ b \in B $, где $ B $ — множество всех возможных контейнеров) называют несекретные данные, используемые для сокрытия сообщений. В цифровой стеганографии роль контейнеров играют растровые графические изображения, цифровой звук, а также текстовые и другие электронные документы.

\textit{Сообщением} $ m $ ($ m \in M $, где $ M $ — множество всех возможных сообщений) называют секретную информацию, скрываемую в контейнере.

\textit{Ключом} $ k $ ($ k \in K $, где $ K $ — множество всех возможных секретных ключей) называют секретную информацию, известную только санкционированному пользователю стеганосистемы, которая определяет конкретный способ сокрытия и извлечения сообщения. В широком смысле ключ — это неизвестный противнику способ (алгоритм) сокрытия информации, в узком — параметр заранее оговорённого стеганографического алгоритма, без знания которого извлечение сообщения невозможно.

\textit{Пустой контейнер} --- это некоторый контейнер $ b $, не содержащий какого-либо сообщения $ m $.

\textit{Заполненный контейнер} --- это контейнер $ b $, содержащий сообщение $ m $.

Помимо приведённых определений распространены следующие термины.

\textit{Стеганографическая система (стегосистема)} --- совокупность средств, осуществляющих встраивание сообщения в контейнер и его последующее извлечение.

\textit{Пропускная способность стегосистемы} --- отношение максимально возможного объёма встроенного сообщения к объёму контейнера при сохранении необходимого уровня стегоустойчивости.

\textit{Стегоустойчивость} --- свойство стегосистемы, характеризующее её способность обеспечивать заданное качество стегосвязи в условиях наличия различных деструктивных факторов (шумы, атаки противодействия передаче сообщения).

Общая схема стеганографической системы приведена на рис. 1.1. Согласно ей, на передающей стороне сообщение скрывается в контейнере при помощи прямого стеганографического преобразования. Затем полученный заполненный контейнер по открытому каналу связи отправляется принимающей стороне, где при помощи обратного стеганографического преобразования извлекается исходное сообщение.

% Рисунок 1.1 -- Обобщённая схема стеганографической системы
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{include/graphics/im_1-stego_system}
\caption{Обобщённая схема стеганографической системы}
\label{fig:StegoSystem}
\end{figure}

Задача \textit{пассивного противника} состоит в определении факта наличия в контейнере сокрытых данных (атака детектирования). \textit{Активный противник} пытается вносить изменения в контейнер или, в простейшем случае, уничтожить передаваемое сообщение (атака уничтожения данных).

\subsection{Метод замены наименее значимого бита}

Наиболее распространённым и примитивным методом сокрытия данных в пространственной области изображений является метод замены наименее значимого бита (англ. Least Significant Bit replacing; также метод замены НЗБ). Одним из его основных преимуществ является низкая вычислительная сложность, основным недостатком --- низкая устойчивость к атакам детектирования и уничтожения данных.

Здесь и далее $ \mathbf{X} = (x_{ij}) \in \mathbb{Q} = \{0, \dotsc, 255\}^{n_1 \times n_2} $ обозначает пустой стегоконтейнер в оттенках серого размера $ {n_1 \times n_2} $, а $ \mathbf{Y} = (y_{ij}) \in \mathbb{Q} $~--- соответствующий заполненный контейнер.

Младший бит пикселя изображения в оттенках серого хранит младший разряд соответствующего двоичного числа и, следовательно, его изменение минимально влияет на изменение числа в целом. Отсюда следует, что встраивание произвольной битовой последовательности в младшие биты пикселей повлечёт за собой минимальной визуальное искажение стегоконтейнера. К тому же, такая методика встраивания обеспечивает довольно высокую пропускную способность: 1 бит/пиксель.

Пустой контейнер можно представить в двоичной форме следующим образом:

\begin{equation*}
(x_{ij}) = \sum_{p = 0}^8 (x_{ij})_m \cdot 2^i.
\end{equation*}

Тогда заполненный стегоконтейнер имеет вид:

\begin{equation*}
(y_{ij}) = \sum_{p = 1}^8 (x_{ij})_m \cdot 2^i + m_{ij},
\end{equation*}
где $ m_{ij} \in {0, 1} $ --- бит сообщения.

Существует множество нетривиальных модификаций данного метода. Интересным для рассмотрения примером является алгоритм, описанный в~\ref{FridrichLossless}. Он предназначен для стеговстраивания цифровых водяных знаков. В таком случае контейнер является не только средой передачи сообщения, которую можно выбрать для обеспечения необходимого уровня скрытности и пропускной способности относительно конкретного сообщения, но и несёт собственную ценность, что повышает требования к уровню искажений, вносимых при стеговстраивании. К тому же, в некоторых областях применения (например, в медицинской отрасли) наличие искажений, приемлемых для передачи сообщений, недопустимо. Рассматриваемый метод учитывает это и обеспечивает обратимость внесения искажений.

Первым шагом для встраивания является разделение пикселей $ (x_{ij}) $ на непересекающиеся группы из $ n $ пикселей $ G = (x_1, x_2, \cdot, x_n) $. Для примера выбираются группы из $ n = 4 $ последовательных пикселей в строке. Затем определяется различающая функция $ f(x_1, x_2, \cdot, x_n) \in \mathbb{R} $, имеющая следующий вид:

\begin{equation*}
f(x_1, x_2, \cdot, x_n) = \sum_{i = 1}^{n - 1} \lvert x_{i + 1} - x_i \rvert.
\end{equation*}

Назначением данной функции является оценка гладкости или «регулярности» группы пикселей~$ G $.

\subsection{Основные принципы и подходы стегоанализа}

\textit{Стегоанализ} — это наука о выявлении факта передачи скрытой информации в анализируемых данных, её извлечении или уничтожении.

В зависимости от наличия априорных знаний о стегосистеме, задействованной при стеговстраивании, применяются направленные или слепые методы стегоанализа. \textit{Направленные} методы стегоанализа предназначены для выявления присутствия сообщения, вложенного известным стегоаналитику методом. В случае отсутствия данных о стегоалгоритме встраивания используют методы \textit{слепого} стегоанализа.

Следующий критерий классификации стегоаналитических методов --- используемый подход. В зависимости от подхода можно выделить \textit{визуальные}, \textit{сигнатурные}, \textit{схемные} и \textit{статистические} методы. Рассмотрим их применительно к стегоанализу цифровых неподвижных изображений.

\textbf{Визуальные методы} основаны на способностях зрительной системы человека, а именно, возможности анализировать зрительные образы и определять различия в сопоставляемых изображениях.

Такие методы стегоанализа графических файлов являются самыми простыми в реализации, но они неспособны обнаружить сообщения, встроенные с помощью современных методов стеговстраивания, и подвержены влиянию человеческого фактора в лице оператора-аналитика.

Подходом \textbf{сигнатурных методов} является синтаксический анализ последовательности битов анализируемого контейнера.

В первых известных алгоритмах сокрытия сообщений в цифровых изображениях заполнение контейнера производилось путём замены служебных атрибутов файла на встраиваемую информацию~\cite{FridrichBook}, что позволяло относительно просто составить сигнатуру, характеризующую заполненный стегоконтейнер, и свести задачу стегоанализа к задаче поиска сигнатуры.

Дальнейшее усовершенствование стеганографических методов привело к широкому распространению стегосистем, осуществляющих встраивание в пространственной области изображения, но сигнатурные методы всё ещё могли противостоять таким стегосистемам. Например, в работе~\cite{HideAndSeek} описывается сигнатурный метод стегоанализа изображений в оттенках серого, стеганографически заполненных с помощью программы Hide and Seek версий 4.1 и 5.0. Заполненный контейнер представляет собой изображение, содержащее три канала цветности (цветовая модель RGB) с одинаковыми значениями яркости в каждом. Наиболее распространённым способом хранения трёхканальных изображений является кодирование каждой цветовой координаты пикселя 8-битным числом, определяющим диапазон уровней квантования $ \mathbb{Q} = \{0, \dotsc,255\} $ и шаг квантования $ h = 1 $. Hide and Seek использует $ \mathbb{Q} = \{0, \dotsc,252\} $ и $ h = 4 $, что позволяет выделить контейнеры, заполненные этой программой, на общем фоне благодаря меньшему количеству градаций яркости и отсутствию абсолютно белого цвета. Столь грубый подход также приводит к высокой визуальной заметности стеганографического искажения, вплоть до очевидного повреждения изображения~(рис.~\ref{fig:HideAndSeek}).

\begin{figure}
     \centering
     \hspace*{\fill}%
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{include/graphics/im_2-hide_and_seek_before}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{include/graphics/im_3-hide_and_seek_after}
%         \caption{$y=3sinx$}
         %\label{fig:three sin x}
     \end{subfigure}
     \hspace*{\fill}%
     \caption{Пустой и заполненный в Hide and Seek контейнеры}
     \label{fig:HideAndSeek}
\end{figure}


Преимуществом данного подхода является высокая скорость работы реализующих его алгоритмов, но сильная привязка к атрибутам заполненных стегоконтейнеров, не учитывающая принципы стеговстраивания, является существенным недостатком, не позволяющим широко использовать данный подход.

\textbf{Схемные методы} применяются для проверки гипотез о наличии стеганографического встраивания с применением известной стегосистемы.

Основными достоинствами схемных методов являются низкая вероятность возникновения ошибок и возможность идентификации стеганографической системы с последующим извлечением сообщения.

Фатальными недостатками данного подхода являются невозможность реализовать необходимое для применения слепого стегоанализа количество стегосистем и многообразие ключей, позволяющее стегосистеме менять характер стеговстраивания от одного ключа к другому.

\textbf{Статистические методы} базируются на понятии «естественного» контейнера. Их суть заключается в оценивании вероятности существования стегосообщения, встроенного неизвестной стегосистемой на основе критерия близости исследуемого контейнера к «естественному» путём обнаружении отклонения анализируемой информации от ожидаемой модели.

Преимуществом подхода является возможность применения в слепом стегоанализе, недостатком — высокая сложность создания модели «естественного» контейнера.

\subsection{Известные методы стегоанализа на основе статистической обработки данных}

\subsubsection{Метод анализа гистограмм}

Метод анализа гистограмм применяется при наличии гипотезы о распределении элементов пустого контейнера $ (x_{ij}) $. Для анализируемого контейнера $ (u_{ij}) $, о заполненности которого нет априорного знания, строят такую же гистограмму. По отклонению распределения, полученного для $ (u_{ij}) $, от распределения, характерного для $ (x_{ij}) $, судят о заполненности $ (u_{ij}) $. Примером атаки на стегосистему, использующую метод замены наименее значимого бита, может служить построение гистограммы яркости пикселей. Рис.~\ref{fig:LSBHists} наглядно иллюстрирует эффект группировки различных значений яркости, вызванный заменой НЗБ и выражающейся в ступенчатом характере гистограммы.

\begin{figure}
     \centering
     \begin{subfigure}{\textwidth}
         \centering
         \includegraphics[width=\textwidth]{include/graphics/im_4-before_lsb_subst}
     \end{subfigure}
     \hfill
     \begin{subfigure}{\textwidth}
         \centering
         \includegraphics[width=\textwidth]{include/graphics/im_5-after_lsb_subst}
     \end{subfigure}
     \caption{Гистограммы до и после применения метода замены НЗБ}
     \label{fig:LSBHists}
\end{figure}

Данный метод также используется для анализа частоты появления серий $ k $ наименее значимых битов значений яркости пикселей. Для построения гистограммы подсчитывается частота равенства последнего НЗБ нулю и единице ($ k = 1 $), двух НЗБ сериям-двойкам ($ 00 $, $ 01 $, $ 10 $, $ 11 $; $ k = 2 $), трёх НЗБ сериям-тройкам ($ 000 $, $ 001 $, $ 010 $, $ 011 $, $ 100 $, $ 101 $, $ 110 $, $ 111 $; $ k = 3 $) и т. д. Для заполненных контейнеров характерна близость частот, в пустых данная симметрия не наблюдается.

\subsection{Применение глубоких искусственных нейронных сетей в задачах стегоанализа}
\subsubsection{Свёрточная нейронная сеть GNCNN}

Модель свёрточной нейронной сети для стегоанализа изображений в оттенках серого GNCNN была предложена в~\cite{GNCNN}. Её основные отличительные особенности: применение фильтра предварительной обработки и использование функции Гаусса в качестве функции активации нейронов свёрточных слоёв.

\begin{equation}
\label{eq:GNCNNConvKernel}
%\begin{align*}
K = \frac{1}{12}
\begin{pmatrix*}[r]
    -1 &  2 &    -2 &  2 & -1 \\
     2 & -6 &     8 & -6 &  2 \\
    -2 &  8 & -12 &  8 & -2 \\
     2 & -6 &     8 & -6 &  2 \\
    -1 &  2 &    -2 &  2 & -1 \\
\end{pmatrix*}
%\end{align*}
\end{equation}

Полосовой высокочастотный фильтр предварительной обработки с импульсной характеристикой~\eqref{eq:GNCNNConvKernel} введён исходя из априорного знания о слабом характере стеговоздействия на стегоконтейнер. Целью предварительной фильтрации является усиление яркости стегосигнала и ослабление яркости оригинального изображения. Веса данного фильтра заранее предопределены и не участвуют в процессе обучения нейронной сети.

Ещё одним преобразованием, облегчающим процесс извлечения признаков, является переход от оригинального изображения к шумоподобному остатку $ R = (r_{ij}) $, содержащему только предсказания относительно факта стеганографической модификации каждого пикселя:

\begin{equation*}
r_{ij} = y_{ij} - P(N(Y, i, j)),
\end{equation*}

где $ Y = (y_{ij}) $ – стегоконтейнер, а $ P(N(Y, i, j)) $ – оценка значения пикселя $ y_{ij} $, полученная из окружающих его пикселей $ N(Y, i, j) $~\cite{FridrichNoiseResidual}. Ввиду наличия сложных зависимостей между соседними пикселями, в случае отсутствия модификации оценка зачастую будет близка к действительному значению пикселя $ y_{ij} $, а значение $ r_{ij} $ будет близко к нулю.

\begin{equation}
\label{eq:GaussianFunction}
%\begin{align*}
f(x) = e^{-\frac{x^2}{\sigma^2}}
%\end{align*}
\end{equation}

Функция Гаусса~\eqref{eq:GaussianFunction} с нулевым математическим ожиданием в качестве функции активации (рис.~\ref{fig:GaussianFunction}) призвана обеспечить формирование в свёрточном слое нейронной сети такого ядра $ K $, что $ Y*K = R $. Максимальное значение функции в нуле соответствует нулевой ошибке оценки значения $ y_{ij} $ и, следовательно, предположению об отсутствии модификации пикселя стегоконтейнера. Резкий спад по мере удаления от нуля обращает в близкие к нулю значения любой результат свёртки, превышающий порог, определяемый среднеквадратическим отклонением $ \sigma $, влияющим на ширину кривой. В рамках эксперимента использовалось значение $ \sigma = 0,1 $.

% Рисунок 1.2 -- Gaussian function
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{include/graphics/im_2-gaussian_function}
\caption{Функция активации GNCNN}
\label{fig:GaussianFunction}
\end{figure}

В процессе обучения в качестве функции потерь применялась категориальная кросс-энтропия. Используемый метод обучения – Adam со скоростью обучения 0,001, $ \beta_1 = 0,9 $, $ \beta_2 = 0,999 $. Архитектура нейронной сети представлена на рис.~\ref{fig:GNCNNArchitecture} и имеет вид состояний, через которые проходит входное изображение.

% Рисунок 1.3 -- GNCNN Architecture
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{include/graphics/im_3-gncnn_gray_architecture}
\caption{Архитектура GNCNN}
\label{fig:GNCNNArchitecture}
\end{figure}

На вход нейронной сети подаётся изображение в оттенках серого в разрешении 256×256 пикселей. Фильтр предварительной обработки с ядром~\eqref{eq:GNCNNConvKernel} является первым свёрточным слоем и в обучении не участвует. За ним следуют пять свёрточных слоёв, состоящих из 16 каналов. Каждый из них осуществляет операцию свёртки с ядром, формирующимся по мере обучения сети, а также вычисление функции активации и выполнение субдискретизации по среднему с размером окна 3×3 и шагом 2. Первые четыре обучаемых слоя используют ядра размера 3×3, последний – 5×5.

Выход последнего свёрточного слоя представляет собой 256 выделенных признака. Они помещаются в модуль классификации, состоящий из трёх полносвязных слоёв: первые два имеют по 128 нейронов каждый и функцию активации ReLU, последний – два нейрона и функцию активации softmax.

\subsubsection{Нейронная сеть с двумя свёрточными слоями}
Также в рамках работы была рассмотрена свёрточная нейронная сеть для стегоанализа изображений в оттенках серого, предложенная в~\cite{FrenchCNN}. Для корректности эксперимента размеры слоёв были изменены для работы со входными изображениями в разрешении 256×256 пикселей. Архитектура нейронной сети приведена на~\ref{fig:FrenchCNNArchitecture}.

% Рисунок 1.4 -- French CNN Architecture
\begin{figure}[!htb]
\centering
\includegraphics[width=1\textwidth]{include/graphics/im_4-french_gray_architecture}
\caption{Архитектура сети с двумя свёрточными слоями}
\label{fig:FrenchCNNArchitecture}
\end{figure}

На вход нейронной сети подаётся изображение в оттенках серого в разрешении 256×256 пикселей. Первый свёрточный слой имеет размер 3×3, за ним следует свёрточный слой размера 253×253, состоящий из 64 каналов. Оба свёрточных слоя осуществляют операцию свёртки с обучаемым ядром и вычисление функции активации tanh. Результатом их работы являются 64 карты признаков размера 2×2, соединённые с двумя нейронами с функцией активации softmax.

В качестве функции потерь была использована категориальная кросс-энтропия, метод обучения – стохастический градиентный спуск со скоростью обучения 0,005.
\clearpage